{% extends "base.html" %}

{% block title %}Admin Registration - SecureTrainer{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg overflow-hidden mt-10">
    <div class="bg-gradient-to-r from-red-600 to-red-700 py-4 px-6">
        <h2 class="text-xl font-bold text-white flex items-center">
            <i class="fas fa-user-shield mr-2"></i>
            Secure Admin Registration
        </h2>
        <p class="text-red-100 text-sm mt-1">Administrator Account Creation</p>
    </div>

    <div class="p-6">
        <!-- Security Notice -->
        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-triangle text-yellow-400 text-xl"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-yellow-700">
                        <strong class="font-bold">Security Notice:</strong> Admin registration requires a secure registration token. 
                        This token is provided by the system administrator and must be kept confidential.
                    </p>
                </div>
            </div>
        </div>

        <form method="POST" action="{{ url_for('admin.admin_register') }}" data-validate>
            {% if csrf_token is defined and csrf_token %}
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            {% endif %}

            <!-- Registration Token -->
            <div class="mb-6 bg-red-50 p-4 rounded-lg border-2 border-red-200">
                <label for="registration_token" class="block text-gray-700 font-bold mb-2">
                    <i class="fas fa-key text-red-600 mr-2"></i>Registration Token *
                </label>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-lock text-gray-400"></i>
                    </div>
                    <input type="password" id="registration_token" name="registration_token" required
                        class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                        placeholder="Enter secure registration token">
                </div>
                <p class="text-xs text-gray-600 mt-1">
                    <i class="fas fa-info-circle mr-1"></i>This token is required to create admin accounts
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <!-- First Name -->
                <div>
                    <label for="first_name" class="block text-gray-700 font-medium mb-2">First Name *</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-user text-gray-400"></i>
                        </div>
                        <input type="text" id="first_name" name="first_name" required
                            class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                            placeholder="First name">
                    </div>
                </div>

                <!-- Last Name -->
                <div>
                    <label for="last_name" class="block text-gray-700 font-medium mb-2">Last Name *</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-user text-gray-400"></i>
                        </div>
                        <input type="text" id="last_name" name="last_name" required
                            class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                            placeholder="Last name">
                    </div>
                </div>
            </div>

            <!-- Username -->
            <div class="mb-4">
                <label for="username" class="block text-gray-700 font-medium mb-2">Username *</label>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-at text-gray-400"></i>
                    </div>
                    <input type="text" id="username" name="username" required
                        class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                        placeholder="Choose a username">
                </div>
            </div>

            <!-- Email -->
            <div class="mb-4">
                <label for="email" class="block text-gray-700 font-medium mb-2">Email Address *</label>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-envelope text-gray-400"></i>
                    </div>
                    <input type="email" id="email" name="email" required
                        class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                        placeholder="admin@example.com">
                </div>
                <p class="text-xs text-gray-600 mt-1">
                    <i class="fas fa-info-circle mr-1"></i>QR code will be sent to this email
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <!-- Company -->
                <div>
                    <label for="company" class="block text-gray-700 font-medium mb-2">Company</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-building text-gray-400"></i>
                        </div>
                        <input type="text" id="company" name="company" value="SecureTrainer"
                            class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                            placeholder="Company name">
                    </div>
                </div>

                <!-- Department -->
                <div>
                    <label for="department" class="block text-gray-700 font-medium mb-2">Department</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-sitemap text-gray-400"></i>
                        </div>
                        <input type="text" id="department" name="department" value="Administration"
                            class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                            placeholder="Department">
                    </div>
                </div>
            </div>

            <!-- Password -->
            <div class="mb-4">
                <label for="password" class="block text-gray-700 font-medium mb-2">Password *</label>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-lock text-gray-400"></i>
                    </div>
                    <input type="password" id="password" name="password" required minlength="8"
                        class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                        placeholder="Enter secure password">
                </div>
                <p class="text-xs text-gray-600 mt-1">
                    <i class="fas fa-info-circle mr-1"></i>Minimum 8 characters
                </p>
            </div>

            <!-- Confirm Password -->
            <div class="mb-6">
                <label for="confirm_password" class="block text-gray-700 font-medium mb-2">Confirm Password *</label>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-lock text-gray-400"></i>
                    </div>
                    <input type="password" id="confirm_password" name="confirm_password" required minlength="8"
                        class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                        placeholder="Confirm password">
                </div>
            </div>

            <!-- Admin Privileges Notice -->
            <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <i class="fas fa-shield-alt text-blue-400 text-xl"></i>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm font-bold text-blue-800 mb-2">Administrator Privileges</h3>
                        <ul class="text-xs text-blue-700 space-y-1">
                            <li><i class="fas fa-check mr-1"></i> Full access to admin dashboard</li>
                            <li><i class="fas fa-check mr-1"></i> User management and role assignment</li>
                            <li><i class="fas fa-check mr-1"></i> Challenge creation and management</li>
                            <li><i class="fas fa-check mr-1"></i> System analytics and monitoring</li>
                        </ul>
                    </div>
                </div>
            </div>

            <button type="submit"
                class="w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-bold py-3 px-4 rounded-md transition duration-200 flex items-center justify-center">
                <i class="fas fa-user-plus mr-2"></i>
                Create Admin Account
            </button>
        </form>

        <div class="mt-6 text-center border-t pt-4">
            <p class="text-sm text-gray-600 mb-2">Already have an admin account?</p>
            <a href="{{ url_for('admin.admin_login') }}" class="text-red-600 hover:text-red-800 font-medium text-sm">
                <i class="fas fa-sign-in-alt mr-1"></i> Go to Admin Login
            </a>
        </div>
    </div>
</div>

<script>
    // Password match validation
    document.querySelector('form').addEventListener('submit', function(e) {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirm_password').value;
        
        if (password !== confirmPassword) {
            e.preventDefault();
            alert('Passwords do not match!');
            return false;
        }
        
        if (password.length < 8) {
            e.preventDefault();
            alert('Password must be at least 8 characters long!');
            return false;
        }
    });
</script>
{% endblock %}
